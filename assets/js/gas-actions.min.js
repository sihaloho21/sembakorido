const GASActions={getAdminRole(){const t=["admin_role","role","ar"];try{const e=new URL(window.location.href);for(let a=0;a<t.length;a++){const n=String(e.searchParams.get(t[a])||"").trim().toLowerCase();if(n)return localStorage.setItem("sembako_admin_role",n),n}}catch(t){}try{const e=CONFIG.getAdminApiUrl(),a=new URL(e,window.location.origin);for(let e=0;e<t.length;e++){const n=String(a.searchParams.get(t[e])||"").trim().toLowerCase();if(n)return n}}catch(t){}const e=["sembako_admin_role","admin_role","sembako_role"];for(let t=0;t<e.length;t++){const a=String(localStorage.getItem(e[t])||"").trim().toLowerCase();if(a)return a}const a=document.getElementById("settings-admin-role");if(a){const t=String(a.value||"").trim().toLowerCase();if(t)return localStorage.setItem("sembako_admin_role",t),t}return""},getAdminToken(){const t=["token","admin_token","auth_token"];try{const e=new URL(window.location.href);for(let a=0;a<t.length;a++){const n=String(e.searchParams.get(t[a])||"").trim();if(n)return localStorage.setItem("sembako_admin_api_token",n),n}}catch(t){}try{const e=CONFIG.getAdminApiUrl(),a=new URL(e,window.location.origin);for(let e=0;e<t.length;e++){const n=String(a.searchParams.get(t[e])||"").trim();if(n)return n}}catch(t){}const e=["sembako_admin_api_token","sembako_admin_write_token","sembako_admin_token","admin_token","api_token","sembako_api_token","gos_admin_token","gos_api_token"];for(let t=0;t<e.length;t++){const a=e[t],n=String(localStorage.getItem(a)||"").trim();if(n)return n}const a=["settings-admin-token","admin-token-input","admin-token"];for(let t=0;t<a.length;t++){const e=document.getElementById(a[t]);if(!e)continue;const n=String(e.value||"").trim();if(n)return localStorage.setItem("sembako_admin_write_token",n),n}return""},async post(t){let e=CONFIG.getAdminApiUrl();const a=this.getAdminToken(),n=this.getAdminRole();if(a)try{const t=new URL(e,window.location.origin);t.searchParams.get("token")||t.searchParams.set("token",a),e=t.toString()}catch(t){}const o={...t,token:a||t&&t.token||"",admin_token:a||t&&t.admin_token||"",role:n||t&&t.role||"",admin_role:n||t&&t.admin_role||""};o.data&&"object"==typeof o.data&&(o.data={...o.data,token:o.data.token||a||"",admin_token:o.data.admin_token||a||"",role:o.data.role||n||"",admin_role:o.data.admin_role||n||""});const r=new FormData;r.append("json",JSON.stringify(o)),a&&(r.append("token",a),r.append("admin_token",a)),n&&(r.append("role",n),r.append("admin_role",n));const i=await fetch(e,{method:"POST",body:r});if(!i.ok){const t=await i.text();throw new Error(`HTTP ${i.status}: ${t}`)}const s=await i.json();if(s.error)throw new Error(s.error);return s},async create(t,e){return this.post({action:"create",sheet:t,data:e})},async update(t,e,a){return this.post({action:"update",sheet:t,id:e,data:a})},async delete(t,e){return this.post({action:"delete",sheet:t,id:e})},async upsertSetting(t,e){return this.post({action:"upsert_setting",sheet:"settings",data:{key:String(t),value:String(e)}})},async getCreditAccount(t){return this.post({action:"credit_account_get",data:{phone:t}})},async upsertCreditAccount(t){return this.post({action:"credit_account_upsert",data:t||{}})},async createCreditInvoice(t){return this.post({action:"credit_invoice_create",data:t||{}})},async payCreditInvoice(t){return this.post({action:"credit_invoice_pay",data:t||{}})},async applyCreditInvoicePenalty(t){return this.post({action:"credit_invoice_apply_penalty",data:t||{}})},async setCreditAccountStatus(t){return this.post({action:"credit_account_set_status",data:t||{}})},async increaseCreditLimitFromProfit(t){return this.post({action:"credit_limit_from_profit",data:t||{}})},async processPaylaterLimitFromOrders(t){return this.post({action:"process_paylater_limit_from_orders",data:t||{}})},async installPaylaterLimitScheduler(t){return this.post({action:"install_paylater_limit_scheduler",data:t||{}})},async removePaylaterLimitScheduler(){return this.post({action:"remove_paylater_limit_scheduler",data:{}})},async getPaylaterLimitScheduler(){return this.post({action:"get_paylater_limit_scheduler",data:{}})},async runPaylaterDueNotifications(t){return this.post({action:"run_paylater_due_notifications",data:t||{}})},async installPaylaterDueNotificationScheduler(t){return this.post({action:"install_paylater_due_notification_scheduler",data:t||{}})},async removePaylaterDueNotificationScheduler(){return this.post({action:"remove_paylater_due_notification_scheduler",data:{}})},async getPaylaterDueNotificationScheduler(){return this.post({action:"get_paylater_due_notification_scheduler",data:{}})},async runPaylaterPostmortemTwoWeeks(t){return this.post({action:"run_paylater_postmortem_two_weeks",data:t||{}})},async getPaylaterPostmortemLogs(t){return this.post({action:"get_paylater_postmortem_logs",data:t||{}})}};