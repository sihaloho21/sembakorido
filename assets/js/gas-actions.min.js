const GASActions={getAdminToken(){try{const t=CONFIG.getAdminApiUrl(),e=new URL(t,window.location.origin),n=(e.searchParams.get('token')||'').trim();if(n)return n}catch(t){}for(const t of ['sembako_admin_api_token','sembako_admin_token','admin_token']){const e=String(localStorage.getItem(t)||'').trim();if(e)return e}return''},async post(t){const e=CONFIG.getAdminApiUrl(),n=this.getAdminToken(),o=new FormData;o.append('json',JSON.stringify(t)),n&&o.append('token',n);const s=await fetch(e,{method:'POST',body:o});if(!s.ok){const t=await s.text();throw new Error(`HTTP ${s.status}: ${t}`)}const r=await s.json();if(r.error)throw new Error(r.error);return r},async create(t,e){return this.post({action:'create',sheet:t,data:e})},async update(t,e,n){return this.post({action:'update',sheet:t,id:e,data:n})},async delete(t,e){return this.post({action:'delete',sheet:t,id:e})},async upsertSetting(t,e){return this.post({action:'upsert_setting',sheet:'settings',data:{key:String(t),value:String(e)}})}};